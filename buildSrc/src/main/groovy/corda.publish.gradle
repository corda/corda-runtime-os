// This plugin is for providing the standard set of gradle used for all modules
// wishing to publish to the R3 artifactory
if (!project.hasProperty('cordaArtifactoryUsername')) {
    ext.cordaArtifactoryUsername = System.getenv('CORDA_ARTIFACTORY_USERNAME')
}

if (! project.hasProperty('cordaArtifactoryPassword')) {
    ext.cordaArtifactoryPassword = System.getenv('CORDA_ARTIFACTORY_PASSWORD')
}

def releaseType = System.getenv("RELEASE_TYPE") ?: "SNAPSHOT"
def versionSuffix = System.getenv("VERSION_SUFFIX")

switch (releaseType) {
    case "SNAPSHOT":
        version = project.hasProperty("snapshotLabel") ?
                "$flowworkerMajorVersion.$flowworkerMinorVersion.0-${project.property("snapshotLabel")}-SNAPSHOT" :
                "$flowworkerMajorVersion.$flowworkerMinorVersion.0-SNAPSHOT"
        break
    default:
        //default case is builds made on jenkins where versionSuffix is calculated for us by the corda-shared-build-pipeline
        version = "$flowworkerMajorVersion.$flowworkerMinorVersion.$versionSuffix"
}
group = 'net.corda'
pluginManager.apply('com.r3.internal.gradle.plugins.r3Publish')
